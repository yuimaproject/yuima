<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>
Nonsynchronous Cumulative Covariance Estimator — cce • The YUIMA Project</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="
Nonsynchronous Cumulative Covariance Estimator — cce"><meta property="og:description" content="
This function estimates the covariance between two Ito processes when they are observed at discrete times possibly nonsynchronously. It can apply to 
irregularly sampled one-dimensional data as a special case."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">The YUIMA Project</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.15.20</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/yuimaproject/yuima/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1><!-- %%  ~~function to do ... ~~ -->
Nonsynchronous Cumulative Covariance Estimator</h1>
    
    <div class="hidden name"><code>cce.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><!-- %%  ~~ A concise (1-5 lines) description of what the function does. ~~ -->
This function estimates the covariance between two Ito processes when they are observed at discrete times possibly nonsynchronously. It can apply to 
irregularly sampled one-dimensional data as a special case.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">cce</span><span class="op">(</span><span class="va">x</span>, method<span class="op">=</span><span class="st">"HY"</span>, <span class="va">theta</span>, <span class="va">kn</span>, g<span class="op">=</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">x</span>,<span class="fl">1</span><span class="op">-</span><span class="va">x</span><span class="op">)</span>, refreshing <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>    cwise <span class="op">=</span> <span class="cn">TRUE</span>, delta <span class="op">=</span> <span class="fl">0</span>, adj <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">K</span>, <span class="va">c.two</span>, J <span class="op">=</span> <span class="fl">1</span>, <span class="va">c.multi</span>, <span class="va">kernel</span>, <span class="va">H</span>,</span>
<span>    <span class="va">c.RK</span>, eta <span class="op">=</span> <span class="fl">3</span><span class="op">/</span><span class="fl">5</span>, m <span class="op">=</span> <span class="fl">2</span>, ftregion <span class="op">=</span> <span class="fl">0</span>, vol.init <span class="op">=</span> <span class="cn">NA</span>,</span>
<span>    covol.init <span class="op">=</span> <span class="cn">NA</span>, nvar.init <span class="op">=</span> <span class="cn">NA</span>, ncov.init <span class="op">=</span> <span class="cn">NA</span>, <span class="va">mn</span>, alpha <span class="op">=</span> <span class="fl">0.4</span>,</span>
<span>    frequency <span class="op">=</span> <span class="fl">300</span>, avg <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">threshold</span>, <span class="va">utime</span>, psd <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p><!-- %%     ~~Describe \code{x} here~~ -->
an object of  <code><a href="yuima-class.html">yuima-class</a></code> or <code><a href="yuima.data-class.html">yuima.data-class</a></code>.</p></dd>

  <dt>method</dt>
<dd><p><!-- %%     ~~Describe \code{method} here~~ -->
the method to be used. See `Details'.</p></dd>

  <dt>theta</dt>
<dd><p><!-- %%     ~~Describe \code{theta} here~~ -->
a numeric vector or matrix. If it is a matrix, each of its components   indicates the tuning parameter which determines the pre-averaging window lengths <code>kn</code> to be used for estimating the corresponding component. If it is a numeric vector, it is converted to a matrix as <code>(C+t(C))/2</code>, where <code>C=matrix(theta,d,d)</code> and <code>d=dim(x)</code>. The default value is <code>0.15</code> for the method <code>"PHY"</code> or <code>"PTHY"</code> following Christensen et al. (2013), while it is <code>1</code> for the method <code>"MRC"</code> following Christensen et al. (2010).</p></dd>

  <dt>kn</dt>
<dd><p><!-- %%     ~~Describe \code{kn} here~~ -->
an integer-valued vector or matrix indicating the pre-averaging window length(s). For the methods <code>"PHY"</code> or <code>"PTHY"</code>, see `Details' for the default value. For the method <code>"MRC"</code>, the default value is <code>ceiling(theta*n^(1+delta))</code>, where <code>n</code> is the number of the refresh times associated with the data minus 1.</p></dd>

  <dt>g</dt>
<dd><p><!-- %%     ~~Describe \code{g} here~~ -->
a function indicating the weight function to be used. The default value is the Bartlett window: <code>function(x)min(x,1-x)</code>.</p></dd>

  <dt>refreshing</dt>
<dd><p><!-- %%     ~~Describe \code{refreshing} here~~ -->
logical. If <code>TRUE</code>, the data is pre-synchronized by the next-tick interpolation in the refresh times.</p></dd>

  <dt>cwise</dt>
<dd><p><!-- %%     ~~Describe \code{cwise} here~~ -->
logical. If <code>TRUE</code>, the estimator is calculated componentwise.</p></dd>

  <dt>delta</dt>
<dd><p><!-- %%     ~~Describe \code{delta} here~~ -->
a non-negative number indicating the order of the pre-averaging window length(s) <code>kn</code>.</p></dd>

  <dt>adj</dt>
<dd><p><!-- %%     ~~Describe \code{adj} here~~ -->
logical. If <code>TRUE</code>, a finite-sample adjustment is performed. For the method <code>"MRC"</code>, see Christensen et al. (2010) for details. For the method <code>"TSCV"</code>, see Zhang (2011) and Zhang et al. (2005) for details.</p></dd>

  <dt>K</dt>
<dd><p><!-- %%     ~~Describe \code{K} here~~ -->
a positive integer indicating the large time-scale parameter. The default value is <code>ceiling(c.two*n^(2/3))</code>, where <code>n</code> is the number of the refresh times associated with the data minus 1.</p></dd>

  <dt>c.two</dt>
<dd><p><!-- %%     ~~Describe \code{c.two} here~~ -->
a positive number indicating the tuning parameter which determines the scale of the large time-scale parameter <code>K</code>. The default value is the average of the  numeric vector each of whose components is the roughly estimated optimal value in the sense of the minimizer of the theoretical asymptotic variance of the estimator of the corresponding diagonal component. The theoretical asymptotic variance is considered in the standard case and given by Eq.(63) of Zhang et al. (2005).</p></dd>

  <dt>J</dt>
<dd><p><!-- %%     ~~Describe \code{J} here~~ -->
a positive integer indicating the small time-scale parameter.</p></dd>

  <dt>c.multi</dt>
<dd><p><!-- %%     ~~Describe \code{c.multi} here~~ -->
a numeric vector or matrix. If it is a matrix, each of its components   indicates the tuning parameter which determines (the scale of) the number of the time scales to be used for estimating the corresponding component. If it is a numeric vector, it is converted to a matrix as <code>(C+t(C))/2</code>, where <code>C=matrix(c.multi,d,d)</code> and <code>d=dim(x)</code>. The default value is the numeric vector each of whose components is the roughly estimated optimal value in the sense of minimizing the theoretical asymptotic variance of the estimator of the corresponding diagonal component. The theoretical asymptotic variance is considered in the standard case and given by Eq.(37) of Zhang (2006).</p></dd>

  <dt>kernel</dt>
<dd><p><!-- %%     ~~Describe \code{kernel} here~~ -->
a function indicating the kernel function to be used. The default value is the Parzan kernel, which is recommended in Barndorff-Nielsen et al. (2009, 2011).</p></dd>

  <dt>H</dt>
<dd><p><!-- %%     ~~Describe \code{H} here~~ -->
a positive number indicating the bandwidth parameter. The default value is <code>c.RK*n^eta</code>, where <code>n</code> is the number of the refresh times associated with the data minus 1.</p></dd>

  <dt>c.RK</dt>
<dd><p><!-- %%     ~~Describe \code{c.RK} here~~ -->
a positive number indicating the tuning parameter which determines the scale of the bandwidth parameter <code>H</code>. The default value is the average of the numeric vector each of whose components is the roughly estimated optimal value in the sense of minimizing the theoretical asymptotic variance of the estimator of the corresponding diagonal component. The theoretical asymptotic variance is considered in the standard case and given in Barndorff-Nielsen et al. (2009, 2011).</p></dd>

  <dt>eta</dt>
<dd><p><!-- %%     ~~Describe \code{eta} here~~ -->
a positive number indicating the tuning parameter which determines the order of the bandwidth parameter <code>H</code>.</p></dd>

  <dt>m</dt>
<dd><p><!-- %%     ~~Describe \code{m} here~~ -->
a positive integer indicating the number of the end points to be jittered.</p></dd>

  <dt>ftregion</dt>
<dd><p><!-- %%     ~~Describe \code{ftregion} here~~ -->
a non-negative number indicating the length of the flat-top region. <code>ftregion=0</code> (the default) means that a non-flat-top realized kernel studied in Barndorff-Nielsen et al. (2011) is used. <code>ftregion=1/H</code> means that a flat-top realized kernel studied in Barndorff-Nielsen et al. (2008) is used. See Varneskov (2015) for other values.</p></dd>

  <dt>vol.init</dt>
<dd><p><!-- %%     ~~Describe \code{vol.init} here~~ -->
a numeric vector each of whose components indicates the initial value to be used to estimate the integrated volatility of the corresponding component, which is passed to the optimizer. <!-- %Components involving \code{NA} are filled with the rough estimated true values.  --></p></dd>

  <dt>covol.init</dt>
<dd><p><!-- %%     ~~Describe \code{covol.init} here~~ -->
a numeric matrix each of whose columns indicates the initial value to be used to estimate the integrated covariance of the corresponding component, which is passed to the optimizer. <!-- %Components involving \code{NA} are filled with the rough estimated true values. --></p></dd>

  <dt>nvar.init</dt>
<dd><p><!-- %%     ~~Describe \code{nvar.init} here~~ -->
a numeric vector each of whose components indicates the initial value to be used to estimate the variance of noise of the corresponding component, which is passed to the optimizer. <!-- %Components involving \code{NA} are filled with the rough estimated true values. --></p></dd>

  <dt>ncov.init</dt>
<dd><p><!-- %%     ~~Describe \code{ncov.init} here~~ -->
a numeric matrix each of whose columns indicates the initial value to be used to estimate the covariance of noise of the corresponding component, which is passed to the optimizer. <!-- %Components involving \code{NA} are filled with the rough estimated true values. --></p></dd>

  <dt>mn</dt>
<dd><p><!-- %%     ~~Describe \code{mn} here~~ -->
a positive integer indicating the number of terms to be used for calculating the SIML estimator. The default value is <code>ceiling(n^alpha)</code>, where <code>n</code> is the number of the refresh times associated with the data minus 1.</p></dd>

  <dt>alpha</dt>
<dd><p><!-- %%     ~~Describe \code{alpha} here~~ -->
a postive number indicating the order of <code>mn</code>.</p></dd>

  <dt>frequency</dt>
<dd><p><!-- %%     ~~Describe \code{frequency} here~~ -->
a positive integer indicating the frequency (seconds) of the calendar time sampling to be used.</p></dd>

  <dt>avg</dt>
<dd><p><!-- %%     ~~Describe \code{avg} here~~ -->
logical. If <code>TRUE</code>, the averaged subsampling estimator is calculated. Otherwise the simple sparsely subsampled estimator is calculated.</p></dd>

  <dt>threshold</dt>
<dd><p><!-- %%     ~~Describe \code{threshold} here~~ -->
a numeric vector or list indicating the threshold parameter(s). Each of its components indicates the threshold parameter or process to be used for estimating the corresponding component. If it is a numeric vector, the elements in <code>threshold</code> are recycled if there are two few elements in <code>threshold</code>. The default value is determined following Koike (2014) (for the method <code>"THY"</code>) and Koike (2015) (for the method <code>"PTHY"</code>).</p></dd>

  <dt>utime</dt>
<dd><p><!-- %%     ~~Describe \code{utime} here~~ -->
a positive number indicating what seconds the interval [0,1] corresponds to. 
<!-- %The default value is 23400 (this means 6.5 hours) if the time indices of the (first component) of \code{x} is numeric, otherwise 1. -->
The default value is the difference between the maximum and the minimum of the sampling times, multiplied by 23,400. Here, 23,400 seconds correspond to 6.5 hours, hence if the data is sampled on the interval [0,1], then the sampling interval is regarded as 6.5 hours.</p></dd>

<dt>psd</dt>
<dd><p>logical. If <code>TRUE</code>, the estimated covariance matrix <code>C</code> is converted to <code>(C%*%C)^(1/2)</code> for ensuring the positive semi-definiteness. In this case the absolute values of the estimated correlations are always ensured to be less than or equal to 1.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p><!-- %%  ~~ If necessary, more details than the description above ~~ -->
This function is a method for objects of <code><a href="yuima.data-class.html">yuima.data-class</a></code> and <code><a href="yuima-class.html">yuima-class</a></code>.
It extracts the <code>data</code> slot when applied to a an object of <code><a href="yuima-class.html">yuima-class</a></code>.</p>
<p>Typical usages are</p><div class="sourceCode"><pre><code><span></span>
<span><span class="fu"><a href="../reference/cce.html">cce</a></span><span class="op">(</span><span class="va">x</span>,psd<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/cce.html">cce</a></span><span class="op">(</span><span class="va">x</span>,method<span class="op">=</span><span class="st">"PHY"</span>,<span class="va">theta</span>,<span class="va">kn</span>,<span class="va">g</span>,refreshing<span class="op">=</span><span class="cn">TRUE</span>,cwise<span class="op">=</span><span class="cn">TRUE</span>,psd<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/cce.html">cce</a></span><span class="op">(</span><span class="va">x</span>,method<span class="op">=</span><span class="st">"MRC"</span>,<span class="va">theta</span>,<span class="va">kn</span>,<span class="va">g</span>,delta<span class="op">=</span><span class="fl">0</span>,avg<span class="op">=</span><span class="cn">TRUE</span>,psd<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/cce.html">cce</a></span><span class="op">(</span><span class="va">x</span>,method<span class="op">=</span><span class="st">"TSCV"</span>,<span class="va">K</span>,<span class="va">c.two</span>,J<span class="op">=</span><span class="fl">1</span>,adj<span class="op">=</span><span class="cn">TRUE</span>,<span class="va">utime</span>,psd<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/cce.html">cce</a></span><span class="op">(</span><span class="va">x</span>,method<span class="op">=</span><span class="st">"GME"</span>,<span class="va">c.multi</span>,<span class="va">utime</span>,psd<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/cce.html">cce</a></span><span class="op">(</span><span class="va">x</span>,method<span class="op">=</span><span class="st">"RK"</span>,<span class="va">kernel</span>,<span class="va">H</span>,<span class="va">c.RK</span>,eta<span class="op">=</span><span class="fl">3</span><span class="op">/</span><span class="fl">5</span>,m<span class="op">=</span><span class="fl">2</span>,ftregion<span class="op">=</span><span class="fl">0</span>,<span class="va">utime</span>,psd<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/cce.html">cce</a></span><span class="op">(</span><span class="va">x</span>,method<span class="op">=</span><span class="st">"QMLE"</span>,vol.init<span class="op">=</span><span class="cn">NULL</span>,covol.init<span class="op">=</span><span class="cn">NULL</span>,</span>
<span>    nvar.init<span class="op">=</span><span class="cn">NULL</span>,ncov.init<span class="op">=</span><span class="cn">NULL</span>,psd<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/cce.html">cce</a></span><span class="op">(</span><span class="va">x</span>,method<span class="op">=</span><span class="st">"SIML"</span>,<span class="va">mn</span>,alpha<span class="op">=</span><span class="fl">0.4</span>,psd<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/cce.html">cce</a></span><span class="op">(</span><span class="va">x</span>,method<span class="op">=</span><span class="st">"THY"</span>,<span class="va">threshold</span>,psd<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/cce.html">cce</a></span><span class="op">(</span><span class="va">x</span>,method<span class="op">=</span><span class="st">"PTHY"</span>,<span class="va">theta</span>,<span class="va">kn</span>,<span class="va">g</span>,<span class="va">threshold</span>,refreshing<span class="op">=</span><span class="cn">TRUE</span>,cwise<span class="op">=</span><span class="cn">TRUE</span>,psd<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/cce.html">cce</a></span><span class="op">(</span><span class="va">x</span>,method<span class="op">=</span><span class="st">"SRC"</span>,frequency<span class="op">=</span><span class="fl">300</span>,avg<span class="op">=</span><span class="cn">TRUE</span>,<span class="va">utime</span>,psd<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/cce.html">cce</a></span><span class="op">(</span><span class="va">x</span>,method<span class="op">=</span><span class="st">"SBPC"</span>,frequency<span class="op">=</span><span class="fl">300</span>,avg<span class="op">=</span><span class="cn">TRUE</span>,<span class="va">utime</span>,psd<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>

<p>The default method is method <code>"HY"</code>, which is an implementation of the Hayashi-Yoshida estimator proposed in Hayashi and Yoshida (2005).
<br><br>
Method <code>"PHY"</code> is an implementation of the Pre-averaged Hayashi-Yoshida estimator proposed in Christensen et al. (2010).
<br><br>
Method <code>"MRC"</code> is an implementation of the Modulated Realized Covariance based on refresh time sampling proposed in Christensen et al. (2010).
<br><br>
Method <code>"TSCV"</code> is an implementation of the previous tick Two Scales realized CoVariance based on refresh time sampling proposed in Zhang (2011).
<br><br>
Method <code>"GME"</code> is an implementation of the Generalized Multiscale Estimator proposed in Bibinger (2011).
<br><br>
Method <code>"RK"</code> is an implementation of the multivariate Realized Kernel based on refresh time sampling proposed in Barndorff-Nielsen et al. (2011).
<br><br>
Method <code>"QMLE"</code> is an implementation of the nonparametric Quasi Maximum Likelihood Estimator proposed in Ait-Sahalia et al. (2010).
<br><br>
Method <code>"SIML"</code> is an implementation of the Separating Information Maximum Likelihood estimator proposed in Kunitomo and Sato (2013) with the basis of refresh time sampling.
<br><br>
Method <code>"THY"</code> is an implementation of the Truncated Hayashi-Yoshida estimator proposed in Mancini and Gobbi (2012).
<br><br>
Method <code>"PTHY"</code> is an implementation of the Pre-averaged Truncated Hayashi-Yoshida estimator, which is a thresholding version of the pre-averaged Hayashi-Yoshida estimator.
<br><br>
Method <code>"SRC"</code> is an implementation of the calendar time Subsampled Realized Covariance.
<br><br>
Method <code>"SBPC"</code> is an implementation of the calendar time Subsampled realized BiPower Covariation.
<br><br>
The rough estimation procedures for selecting the default values of the tuning parameters are based on those in Barndorff-Nielsen et al. (2009).
<br><br>
For the methods <code>"PHY"</code> or <code>"PTHY"</code>, the default value of <code>kn</code> changes depending on the values of <code>refreshing</code> and <code>cwise</code>. If both <code>refreshing</code> and <code>cwise</code> are <code>TRUE</code> (the default), the default value of <code>kn</code> is given by the matrix <code>ceiling(theta*N)</code>, where <code>N</code> is a matrix whose diagonal components are identical with the vector <code>length(x)-1</code> and whose \((i,j)\)-th component is identical with the number of the refresh times associated with \(i\)-th and \(j\)-th components of <code>x</code> minus 1. If <code>refreshing</code> is <code>TRUE</code> while <code>cwise</code> is <code>FALSE</code>, the default value of <code>kn</code> is given by <code>ceiling(mean(theta)*sqrt(n))</code>, where <code>n</code> is the number of the refresh times associated with the data minus 1. If <code>refreshing</code> is <code>FALSE</code> while <code>cwise</code> is <code>TRUE</code>, the default value of <code>kn</code> is given by the matrix <code>ceiling(theta*N0)</code>, where <code>N0</code> is a matrix whose diagonal components are identical with the vector <code>length(x)-1</code> and whose \((i,j)\)-th component is identical with <code>(length(x)[i]-1)+(length(x)[j]-1)</code>. If both <code>refreshing</code> and <code>cwise</code> are <code>FALSE</code>, the default value of <code>kn</code> is given by <code>ceiling(mean(theta)*sqrt(sum(length(x)-1)))</code> (following Christensen et al. (2013)).
<br><br>
For the method <code>"QMLE"</code>, the optimization of the quasi-likelihood function is implemented via <a href="https://rdrr.io/r/stats/arima0.html" class="external-link">arima0</a> using the fact that it can be seen as an MA(1) model's one: See Hansen et al. (2008) for details.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    

<p><!-- %%  ~Describe the value returned --></p>


<p><!-- %%  If it is a LIST, use --></p>


<p><!-- %%  \item{comp1 }{Description of 'comp1'} --></p>


<p><!-- %%  \item{comp2 }{Description of 'comp2'} --></p>


<p><!-- %% ... --></p>


<p>A list with components:</p>
<dl><dt>covmat</dt>
<dd><p>the estimated covariance matrix</p></dd>

<dt>cormat</dt>
<dd><p>the estimated correlation matrix</p></dd>

</dl></div>
    <div id="references">
    <h2>References</h2>
    <p><!-- %% ~put references to the literature/web site here ~ -->
Ait-Sahalia, Y., Fan, J. and Xiu, D. (2010)
  High-frequency covariance estimates with noisy and asynchronous financial data,
  <em>Journal of the American Statistical Association</em>, <b>105</b>, no. 492, 1504--1517.</p>  
<p>Barndorff-Nielsen, O. E., Hansen, P. R., Lunde, A. and Shephard, N. (2008)
  Designing realised kernels to measure the ex-post variation of equity prices in the presence of noise,
  <em>Econometrica</em>, <b>76</b>, no. 6, 1481--1536.</p>  
<p>Barndorff-Nielsen, O. E., Hansen, P. R., Lunde, A. and Shephard, N. (2009)
  Realized kernels in practice: trades and quotes,
  <em>Econometrics Journal</em>, <b>12</b>, C1--C32.</p>
<p>Barndorff-Nielsen, O. E., Hansen, P. R., Lunde, A. and Shephard, N. (2011)
  Multivariate realised kernels: Consistent positive semi-definite estimators of the covariation of equity prices with noise and non-synchronous trading,
  <em>Journal of Econometrics</em>, <b>162</b>, 149--169.</p>
<p>Bibinger, M. (2011)
  Efficient covariance estimation for asynchronous noisy high-frequency data,
  <em>Scandinavian Journal of Statistics</em>, <b>38</b>, 23--45.</p>  
<p>Bibinger, M. (2012)
  An estimator for the quadratic covariation of asynchronously observed Ito processes with noise: asymptotic distribution theory,
  <em>Stochastic processes and their applications</em>, <b>122</b>, 2411--2453.</p>
<p>Christensen, K., Kinnebrock, S. and Podolskij, M. (2010)
  Pre-averaging estimators of the ex-post covariance matrix in noisy diffusion models with non-synchronous data,
  <em>Journal of Econometrics</em>, <b>159</b>, 116--133.</p>  
<p>Christensen, K., Podolskij, M. and Vetter, M. (2013)
  On covariation estimation for multivariate continuous Ito semimartingales with noise in non-synchronous observation schemes,
  <em>Journal of Multivariate Analysis</em> <b>120</b> 59--84.</p>
<p>Hansen, P. R., Large, J. and Lunde, A. (2008)
  Moving average-based estimators of integrated variance,
  <em>Econometric Reviews</em>, <b>27</b>, 79--111.</p>  
<p>Hayashi, T. and Yoshida, N. (2005)
  On covariance estimation of non-synchronously observed diffusion processes,
  <em>Bernoulli</em>, <b>11</b>, no. 2, 359--379.</p>
<p>Hayashi, T. and Yoshida, N. (2008)
  Asymptotic normality of a covariance estimator for nonsynchronously observed diffusion processes, 
  <em>Annals of the Institute of Statistical Mathematics</em>, <b>60</b>, no. 2, 367--406.</p>
<p>Koike, Y. (2016)
  Estimation of integrated covariances in the simultaneous presence of nonsynchronicity, microstructure noise and jumps,
  <em>Econometric Theory</em>, <b>32</b>, 533--611.</p>  
<p>Koike, Y. (2014)
  An estimator for the cumulative co-volatility of asynchronously observed semimartingales with jumps,
  <em>Scandinavian Journal of Statistics</em>, <b>41</b>, 460--481.</p>  
<p>Kunitomo, N. and Sato, S. (2013)
  Separating information maximum likelihood estimation of realized volatility and covariance with micro-market noise,
  <em>North American Journal of Economics and Finance</em>, <b>26</b>, 282--309.</p>  
<p>Mancini, C. and Gobbi, F. (2012)
  Identifying the Brownian covariation from the co-jumps given discrete observations,
  <em>Econometric Theory</em>, <b>28</b>, 249--273.</p>  
<p>Varneskov, R. T. (2016)
  Flat-top realized kernel estimation of quadratic covariation with non-synchronous and noisy asset prices,
  <em>Journal of Business &amp; Economic Statistics</em>, <b>34</b>, no.1, 1--22.</p>  
<p>Zhang, L. (2006)
  Efficient estimation of stochastic volatility using noisy observations: a multi-scale approach,
  <em>Bernoulli</em>, <b>12</b>, no.6, 1019--1043.</p>
<p>Zhang, L. (2011)
  Estimating covariation: Epps effect, microstructure noise,
  <em>Journal of Econometrics</em>, <b>160</b>, 33--47.</p>  
<p>Zhang, L., Mykland, P. A. and Ait-Sahalia, Y. (2005)
  A tale of two time scales: Determining integrated volatility with noisy high-frequency data,
  <em>Journal of the American Statistical Association</em>, <b>100</b>, no. 472, 1394--1411.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p><!-- %%  ~~who you are~~ -->
Yuta Koike with YUIMA Project Team</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p><!-- %%  ~~further notes~~ -->
The example shows the central limit theorem for the nonsynchronous 
covariance estimator.  
<!-- %Estimation of the asymptotic variance with p-values and -->
Estimation of the asymptotic variance can be implemented by <code><a href="hyavar.html">hyavar</a></code>. 
The second-order correction will be provided in a future version of the package.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><!-- %% ~~objects to See Also as \code{\link{help}}, ~~~ -->
<code><a href="setModel.html">setModel</a></code>, <code><a href="setData.html">setData</a></code>, <code><a href="hyavar.html">hyavar</a></code>, <code><a href="spectralcov.html">lmm</a></code>, <code><a href="cce.factor.html">cce.factor</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">## Set a model</span></span></span>
<span class="r-in"><span><span class="va">diff.coef.1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">x1</span> <span class="op">=</span> <span class="fl">0</span>, <span class="va">x2</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">t</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">diff.coef.2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">x1</span> <span class="op">=</span> <span class="fl">0</span>, <span class="va">x2</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">t</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cor.rho</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>, <span class="va">x1</span> <span class="op">=</span> <span class="fl">0</span>, <span class="va">x2</span> <span class="op">=</span> <span class="fl">0</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">diff.coef.matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"diff.coef.1(t,x1,x2)"</span>, </span></span>
<span class="r-in"><span><span class="st">"diff.coef.2(t,x1,x2) * cor.rho(t,x1,x2)"</span>, </span></span>
<span class="r-in"><span><span class="st">""</span>, <span class="st">"diff.coef.2(t,x1,x2) * sqrt(1-cor.rho(t,x1,x2)^2)"</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">cor.mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="setModel.html">setModel</a></span><span class="op">(</span>drift <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">""</span>, <span class="st">""</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>diffusion <span class="op">=</span> <span class="va">diff.coef.matrix</span>,solve.variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x1"</span>, <span class="st">"x2"</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">111</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## We use a function poisson.random.sampling to get observation by Poisson sampling.</span></span></span>
<span class="r-in"><span><span class="va">yuima.samp</span> <span class="op">&lt;-</span> <span class="fu"><a href="setSampling.html">setSampling</a></span><span class="op">(</span>Terminal <span class="op">=</span> <span class="fl">1</span>, n <span class="op">=</span> <span class="fl">1200</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">yuima</span> <span class="op">&lt;-</span> <span class="fu"><a href="setYuima.html">setYuima</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">cor.mod</span>, sampling <span class="op">=</span> <span class="va">yuima.samp</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">yuima</span> <span class="op">&lt;-</span> <span class="fu"><a href="simulate.html">simulate</a></span><span class="op">(</span><span class="va">yuima</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">psample</span><span class="op">&lt;-</span> <span class="fu"><a href="poisson.random.sampling.html">poisson.random.sampling</a></span><span class="op">(</span><span class="va">yuima</span>, rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>,<span class="fl">0.3</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## cce takes the psample and returns an estimate of the quadratic covariation. </span></span></span>
<span class="r-in"><span><span class="fu">cce</span><span class="op">(</span><span class="va">psample</span><span class="op">)</span><span class="op">$</span><span class="va">covmat</span><span class="op">[</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="co">##cce(psample)[1, 2]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## True value of the quadratic covariation.</span></span></span>
<span class="r-in"><span><span class="va">cc.theta</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">T</span>, <span class="va">sigma1</span>, <span class="va">sigma2</span>, <span class="va">rho</span><span class="op">)</span> <span class="op">{</span> </span></span>
<span class="r-in"><span>  <span class="va">tmp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span> <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu">sigma1</span><span class="op">(</span><span class="va">t</span><span class="op">)</span> <span class="op">*</span> <span class="fu">sigma2</span><span class="op">(</span><span class="va">t</span><span class="op">)</span> <span class="op">*</span> <span class="fu">rho</span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/integrate.html" class="external-link">integrate</a></span><span class="op">(</span><span class="va">tmp</span>, <span class="fl">0</span>, <span class="cn">T</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu">cc.theta</span><span class="op">(</span>T <span class="op">=</span> <span class="fl">1</span>, <span class="va">diff.coef.1</span>, <span class="va">diff.coef.2</span>, <span class="va">cor.rho</span><span class="op">)</span><span class="op">$</span><span class="va">value</span> </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"theta =%.5f\n"</span>, <span class="va">theta</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">psample</span><span class="op">@</span><span class="va">zoo.data</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example. A stochastic differential equation with nonlinear feedback. </span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Set a model</span></span></span>
<span class="r-in"><span><span class="va">drift.coef.1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x1</span>,<span class="va">x2</span><span class="op">)</span> <span class="va">x2</span></span></span>
<span class="r-in"><span><span class="va">drift.coef.2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x1</span>,<span class="va">x2</span><span class="op">)</span> <span class="op">-</span><span class="va">x1</span></span></span>
<span class="r-in"><span><span class="va">drift.coef.vector</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"drift.coef.1"</span>,<span class="st">"drift.coef.2"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">diff.coef.1</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>,<span class="va">x1</span>,<span class="va">x2</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">t</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">diff.coef.2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>,<span class="va">x1</span>,<span class="va">x2</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">abs</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cor.rho</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span>,<span class="va">x1</span>,<span class="va">x2</span><span class="op">)</span> <span class="fl">1</span><span class="op">/</span><span class="op">(</span><span class="fl">1</span><span class="op">+</span><span class="va">x1</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">diff.coef.matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"diff.coef.1(t,x1,x2)"</span>, </span></span>
<span class="r-in"><span><span class="st">"diff.coef.2(t,x1,x2) * cor.rho(t,x1,x2)"</span>,<span class="st">""</span>, </span></span>
<span class="r-in"><span><span class="st">"diff.coef.2(t,x1,x2) * sqrt(1-cor.rho(t,x1,x2)^2)"</span><span class="op">)</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">cor.mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="setModel.html">setModel</a></span><span class="op">(</span>drift <span class="op">=</span> <span class="va">drift.coef.vector</span>,</span></span>
<span class="r-in"><span> diffusion <span class="op">=</span> <span class="va">diff.coef.matrix</span>,solve.variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x1"</span>, <span class="st">"x2"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Generate a path of the process</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">111</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">yuima.samp</span> <span class="op">&lt;-</span> <span class="fu"><a href="setSampling.html">setSampling</a></span><span class="op">(</span>Terminal <span class="op">=</span> <span class="fl">1</span>, n <span class="op">=</span> <span class="fl">10000</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">yuima</span> <span class="op">&lt;-</span> <span class="fu"><a href="setYuima.html">setYuima</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">cor.mod</span>, sampling <span class="op">=</span> <span class="va">yuima.samp</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">yuima</span> <span class="op">&lt;-</span> <span class="fu"><a href="simulate.html">simulate</a></span><span class="op">(</span><span class="va">yuima</span>, xinit<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">yuima</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## The "true" value of the quadratic covariation.</span></span></span>
<span class="r-in"><span><span class="fu">cce</span><span class="op">(</span><span class="va">yuima</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## We use the function poisson.random.sampling to generate nonsynchronous </span></span></span>
<span class="r-in"><span><span class="co">## observations by Poisson sampling.</span></span></span>
<span class="r-in"><span><span class="va">psample</span><span class="op">&lt;-</span> <span class="fu"><a href="poisson.random.sampling.html">poisson.random.sampling</a></span><span class="op">(</span><span class="va">yuima</span>, rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>,<span class="fl">0.3</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">3000</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## cce takes the psample to return an estimated value  of the quadratic covariation. </span></span></span>
<span class="r-in"><span><span class="co">## The off-diagonal elements are the value of the Hayashi-Yoshida estimator. </span></span></span>
<span class="r-in"><span><span class="fu">cce</span><span class="op">(</span><span class="va">psample</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example. Epps effect for the realized covariance estimator</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Set a model</span></span></span>
<span class="r-in"><span><span class="va">drift</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sigma1</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">sigma2</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="va">rho</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">diffusion</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">sigma1</span>,<span class="va">sigma2</span><span class="op">*</span><span class="va">rho</span>,<span class="fl">0</span>,<span class="va">sigma2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">rho</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="setModel.html">setModel</a></span><span class="op">(</span>drift<span class="op">=</span><span class="va">drift</span>,diffusion<span class="op">=</span><span class="va">diffusion</span>,</span></span>
<span class="r-in"><span>                  state.variable<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x1"</span>,<span class="st">"x2"</span><span class="op">)</span>,solve.variable<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x1"</span>,<span class="st">"x2"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>                  </span></span>
<span class="r-in"><span><span class="co">## Generate a path of the latent process</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">116</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## We regard the unit interval as 6.5 hours and generate the path on it </span></span></span>
<span class="r-in"><span><span class="co">## with the step size equal to 2 seconds</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">yuima.samp</span> <span class="op">&lt;-</span> <span class="fu"><a href="setSampling.html">setSampling</a></span><span class="op">(</span>Terminal <span class="op">=</span> <span class="fl">1</span>, n <span class="op">=</span> <span class="fl">11700</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">yuima</span> <span class="op">&lt;-</span> <span class="fu"><a href="setYuima.html">setYuima</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">model</span>, sampling <span class="op">=</span> <span class="va">yuima.samp</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">yuima</span> <span class="op">&lt;-</span> <span class="fu"><a href="simulate.html">simulate</a></span><span class="op">(</span><span class="va">yuima</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## We extract nonsynchronous observations from the path generated above </span></span></span>
<span class="r-in"><span><span class="co">## by Poisson random sampling with the average duration equal to 10 seconds</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">psample</span> <span class="op">&lt;-</span> <span class="fu"><a href="poisson.random.sampling.html">poisson.random.sampling</a></span><span class="op">(</span><span class="va">yuima</span>, rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">/</span><span class="fl">5</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">11700</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Hayashi-Yoshida estimator consistetly estimates the true correlation</span></span></span>
<span class="r-in"><span><span class="fu">cce</span><span class="op">(</span><span class="va">psample</span><span class="op">)</span><span class="op">$</span><span class="va">cormat</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## If we synchronize the observation data on some regular grid </span></span></span>
<span class="r-in"><span><span class="co">## by previous-tick interpolations and compute the correlation </span></span></span>
<span class="r-in"><span><span class="co">## by therealized covariance based on such synchronized observations, </span></span></span>
<span class="r-in"><span><span class="co">## we underestimate the true correlation (known as the Epps effect). </span></span></span>
<span class="r-in"><span><span class="co">## This is illustrated by the following examples.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Synchronization on the grid with 5 seconds steps</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu">cce</span><span class="op">(</span><span class="fu"><a href="subsampling.html">subsampling</a></span><span class="op">(</span><span class="va">psample</span>, sampling <span class="op">=</span> <span class="fu"><a href="setSampling.html">setSampling</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">4680</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">cormat</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">s1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Synchronization on the grid with 10 seconds steps</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="va">s2</span> <span class="op">&lt;-</span> <span class="fu">cce</span><span class="op">(</span><span class="fu"><a href="subsampling.html">subsampling</a></span><span class="op">(</span><span class="va">psample</span>, sampling <span class="op">=</span> <span class="fu"><a href="setSampling.html">setSampling</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">2340</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">cormat</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">s2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Synchronization on the grid with 20 seconds steps</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="va">s3</span> <span class="op">&lt;-</span> <span class="fu">cce</span><span class="op">(</span><span class="fu"><a href="subsampling.html">subsampling</a></span><span class="op">(</span><span class="va">psample</span>, sampling <span class="op">=</span> <span class="fu"><a href="setSampling.html">setSampling</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">1170</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">cormat</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">s3</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Synchronization on the grid with 30 seconds steps</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="va">s4</span> <span class="op">&lt;-</span> <span class="fu">cce</span><span class="op">(</span><span class="fu"><a href="subsampling.html">subsampling</a></span><span class="op">(</span><span class="va">psample</span>, sampling <span class="op">=</span> <span class="fu"><a href="setSampling.html">setSampling</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">780</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">cormat</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">s4</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Synchronization on the grid with 1 minute steps</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/warning.html" class="external-link">suppressWarnings</a></span><span class="op">(</span><span class="va">s5</span> <span class="op">&lt;-</span> <span class="fu">cce</span><span class="op">(</span><span class="fu"><a href="subsampling.html">subsampling</a></span><span class="op">(</span><span class="va">psample</span>, sampling <span class="op">=</span> <span class="fu"><a href="setSampling.html">setSampling</a></span><span class="op">(</span>n <span class="op">=</span> <span class="fl">390</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">$</span><span class="va">cormat</span><span class="op">[</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">s5</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">zoo</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">s1</span>,<span class="va">s2</span>,<span class="va">s3</span>,<span class="va">s4</span>,<span class="va">s5</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">5</span>,<span class="fl">10</span>,<span class="fl">20</span>,<span class="fl">30</span>,<span class="fl">60</span><span class="op">)</span><span class="op">)</span>,type<span class="op">=</span><span class="st">"b"</span>,xlab<span class="op">=</span><span class="st">"seconds"</span>,ylab<span class="op">=</span><span class="st">"correlation"</span>,</span></span>
<span class="r-in"><span>main <span class="op">=</span> <span class="st">"Epps effect for the realized covariance"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example. Non-synchronous and noisy observations of a correlated bivariate Brownian motion</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Generate noisy observations from the model used in the previous example</span></span></span>
<span class="r-in"><span><span class="va">Omega</span> <span class="op">&lt;-</span> <span class="fl">0.005</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">rho</span>,<span class="va">rho</span>,<span class="fl">1</span><span class="op">)</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span> <span class="co"># covariance matrix of noise</span></span></span>
<span class="r-in"><span><span class="va">noisy.psample</span> <span class="op">&lt;-</span> <span class="fu"><a href="noisy.sampling.html">noisy.sampling</a></span><span class="op">(</span><span class="va">psample</span>,var.adj<span class="op">=</span><span class="va">Omega</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">noisy.psample</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Hayashi-Yoshida estimator: inconsistent</span></span></span>
<span class="r-in"><span><span class="fu">cce</span><span class="op">(</span><span class="va">noisy.psample</span><span class="op">)</span><span class="op">$</span><span class="va">covmat</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Pre-averaged Hayashi-Yoshida estimator: consistent</span></span></span>
<span class="r-in"><span><span class="fu">cce</span><span class="op">(</span><span class="va">noisy.psample</span>,method<span class="op">=</span><span class="st">"PHY"</span><span class="op">)</span><span class="op">$</span><span class="va">covmat</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Generalized multiscale estimator: consistent</span></span></span>
<span class="r-in"><span><span class="fu">cce</span><span class="op">(</span><span class="va">noisy.psample</span>,method<span class="op">=</span><span class="st">"GME"</span><span class="op">)</span><span class="op">$</span><span class="va">covmat</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Multivariate realized kernel: consistent</span></span></span>
<span class="r-in"><span><span class="fu">cce</span><span class="op">(</span><span class="va">noisy.psample</span>,method<span class="op">=</span><span class="st">"RK"</span><span class="op">)</span><span class="op">$</span><span class="va">covmat</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Nonparametric QMLE: consistent</span></span></span>
<span class="r-in"><span><span class="fu">cce</span><span class="op">(</span><span class="va">noisy.psample</span>,method<span class="op">=</span><span class="st">"QMLE"</span><span class="op">)</span><span class="op">$</span><span class="va">covmat</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Stefano M. Iacus.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer></div>

  


  

  </body></html>

