<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Adaptive Bayes estimator for the parameters in sde model by using LSE functions — lseBayes • The YUIMA Project</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Adaptive Bayes estimator for the parameters in sde model by using LSE functions — lseBayes"><meta property="og:description" content="Adaptive Bayes estimator for the parameters in a specific type of sde by using LSE functions."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">The YUIMA Project</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.15.24</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/yuimaproject/yuima/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Adaptive Bayes estimator for the parameters in sde model by using LSE functions</h1>

    <div class="hidden name"><code>lseBayes.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Adaptive Bayes estimator for the parameters in a specific type of sde by using LSE functions.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">lseBayes</span><span class="op">(</span><span class="va">yuima</span>, <span class="va">start</span>, <span class="va">prior</span>, <span class="va">lower</span>, <span class="va">upper</span>, method <span class="op">=</span> <span class="st">"mcmc"</span>, mcmc <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>rate <span class="op">=</span><span class="fl">1</span>, algorithm <span class="op">=</span> <span class="st">"randomwalk"</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-yuima">yuima<a class="anchor" aria-label="anchor" href="#arg-yuima"></a></dt>
<dd><p>a 'yuima' object.</p></dd>

  <dt id="arg-start">start<a class="anchor" aria-label="anchor" href="#arg-start"></a></dt>
<dd><p>initial suggestion for parameter values</p></dd>

  <dt id="arg-prior">prior<a class="anchor" aria-label="anchor" href="#arg-prior"></a></dt>
<dd><p>a list of prior distributions for the parameters specified by 'code'. Currently, dunif(z, min, max), dnorm(z, mean, sd), dbeta(z, shape1, shape2), dgamma(z, shape, rate) are available.</p></dd>

  <dt id="arg-lower">lower<a class="anchor" aria-label="anchor" href="#arg-lower"></a></dt>
<dd><p>a named list for specifying lower bounds of parameters</p></dd>

  <dt id="arg-upper">upper<a class="anchor" aria-label="anchor" href="#arg-upper"></a></dt>
<dd><p>a named list for specifying upper bounds of parameters</p></dd>

  <dt id="arg-method">method<a class="anchor" aria-label="anchor" href="#arg-method"></a></dt>
<dd><p><code>nomcmc</code> requires package <code>cubature</code></p></dd>

  <dt id="arg-mcmc">mcmc<a class="anchor" aria-label="anchor" href="#arg-mcmc"></a></dt>
<dd><p>number of iteration of Markov chain Monte Carlo method</p></dd>

  <dt id="arg-rate">rate<a class="anchor" aria-label="anchor" href="#arg-rate"></a></dt>
<dd><p>a thinning parameter. Only the first n^rate observation will be used for inference.</p></dd>

  <dt id="arg-algorithm">algorithm<a class="anchor" aria-label="anchor" href="#arg-algorithm"></a></dt>
<dd><p>Logical value when <code>method = mcmc</code>. If <code>algorithm = "randomwalk"</code> (default), the random-walk Metropolis algorithm will be performed. If <code>algorithm = "MpCN"</code>, the Mixed preconditioned Crank-Nicolson algorithm will be performed.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p><code>lseBayes</code> is always performed by Rcpp code.Calculate the Bayes estimator for stochastic processes by using Least Square Estimate functions. The calculation is performed by the Markov chain Monte Carlo method. Currently, the Random-walk Metropolis algorithm  and the Mixed preconditioned Crank-Nicolson algorithm is implemented.In <code>lseBayes</code>,the LSE function for estimating diffusion parameter differs from the LSE function for estimating drift parameter.<code>lseBayes</code> is similar to <code>adaBayes</code>,but <code>lseBayes</code> calculate faster than <code>adaBayes</code> because of LSE functions.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p></p>
<dl><dt>vector</dt>
<dd><p>a vector of the parameter estimate</p></dd>

</dl></div>
    <div id="author">
    <h2>Author</h2>
    <p>Yuto Yoshida with YUIMA project Team</p>
    </div>
    <div id="note">
    <h2>Note</h2>
    <p><code>algorithm = "nomcmc"</code> is unstable. <code>nomcmc</code> is going to be stopped.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Yoshida, N. (2011). Polynomial type large deviation inequalities and quasi-likelihood analysis for stochastic differential equations. Annals of the Institute of Statistical Mathematics, 63(3), 431-479.</p>
<p>Uchida, M., &amp; Yoshida, N. (2014). Adaptive Bayes type estimators of ergodic diffusion processes from discrete observations. Statistical Inference for Stochastic Processes, 17(2), 181-219.</p>
<p>Kamatani, K. (2017). Ergodicity of Markov chain Monte Carlo with reversible proposal. Journal of Applied Probability, 54(2).</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">####2-dim model</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"-theta1*x1+theta2*sin(x2)+50"</span>,<span class="st">"-theta3*x2+theta4*cos(x1)+25"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"4+theta5*sin(x1)^2"</span>,<span class="st">"1"</span>,<span class="st">"1"</span>,<span class="st">"2+theta6*sin(x2)^2"</span><span class="op">)</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">true</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>theta1 <span class="op">=</span> <span class="fl">0.5</span>, theta2 <span class="op">=</span> <span class="fl">5</span>,theta3 <span class="op">=</span> <span class="fl">0.3</span>, </span></span>
<span class="r-in"><span>            theta4 <span class="op">=</span> <span class="fl">5</span>, theta5 <span class="op">=</span> <span class="fl">1</span>, theta6 <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lower</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>theta1<span class="op">=</span><span class="fl">0.1</span>,theta2<span class="op">=</span><span class="fl">0.1</span>,theta3<span class="op">=</span><span class="fl">0</span>,</span></span>
<span class="r-in"><span>             theta4<span class="op">=</span><span class="fl">0.1</span>,theta5<span class="op">=</span><span class="fl">0.1</span>,theta6<span class="op">=</span><span class="fl">0.1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">upper</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>theta1<span class="op">=</span><span class="fl">1</span>,theta2<span class="op">=</span><span class="fl">10</span>,theta3<span class="op">=</span><span class="fl">0.9</span>,</span></span>
<span class="r-in"><span>             theta4<span class="op">=</span><span class="fl">10</span>,theta5<span class="op">=</span><span class="fl">10</span>,theta6<span class="op">=</span><span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">start</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>theta1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>             theta2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>             theta3<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Beta.html" class="external-link">rbeta</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>             theta4<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>             theta5<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/GammaDist.html" class="external-link">rgamma</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>             theta6<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/stats/Exponential.html" class="external-link">rexp</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">yuimamodel</span> <span class="op">&lt;-</span> <span class="fu"><a href="setModel.html">setModel</a></span><span class="op">(</span>drift<span class="op">=</span><span class="va">b</span>,diffusion<span class="op">=</span><span class="va">a</span>,state.variable<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x1"</span>, <span class="st">"x2"</span><span class="op">)</span>,solve.variable<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x1"</span>,<span class="st">"x2"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">yuimasamp</span> <span class="op">&lt;-</span> <span class="fu"><a href="setSampling.html">setSampling</a></span><span class="op">(</span>Terminal<span class="op">=</span><span class="fl">50</span>,n<span class="op">=</span><span class="fl">50</span><span class="op">*</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">yuima</span> <span class="op">&lt;-</span> <span class="fu"><a href="setYuima.html">setYuima</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">yuimamodel</span>, sampling <span class="op">=</span> <span class="va">yuimasamp</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">yuima</span> <span class="op">&lt;-</span> <span class="fu"><a href="simulate.html">simulate</a></span><span class="op">(</span><span class="va">yuima</span>, xinit <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">100</span>,<span class="fl">80</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                  true.parameter <span class="op">=</span> <span class="va">true</span>,sampling <span class="op">=</span> <span class="va">yuimasamp</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">prior</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        theta1<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>measure.type<span class="op">=</span><span class="st">"code"</span>,df<span class="op">=</span><span class="st">"dunif(z,0,1)"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        theta2<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>measure.type<span class="op">=</span><span class="st">"code"</span>,df<span class="op">=</span><span class="st">"dnorm(z,0,1)"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        theta3<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>measure.type<span class="op">=</span><span class="st">"code"</span>,df<span class="op">=</span><span class="st">"dbeta(z,1,1)"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        theta4<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>measure.type<span class="op">=</span><span class="st">"code"</span>,df<span class="op">=</span><span class="st">"dgamma(z,1,1)"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        theta5<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>measure.type<span class="op">=</span><span class="st">"code"</span>,df<span class="op">=</span><span class="st">"dnorm(z,0,1)"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        theta6<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>measure.type<span class="op">=</span><span class="st">"code"</span>,df<span class="op">=</span><span class="st">"dnorm(z,0,1)"</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mle</span> <span class="op">&lt;-</span> <span class="fu"><a href="qmle.html">qmle</a></span><span class="op">(</span><span class="va">yuima</span>, start <span class="op">=</span> <span class="va">start</span>, lower <span class="op">=</span> <span class="va">lower</span>, upper <span class="op">=</span> <span class="va">upper</span>, method <span class="op">=</span> <span class="st">"L-BFGS-B"</span>,rcpp<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">mle</span><span class="op">@</span><span class="va">coef</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bayes1</span> <span class="op">&lt;-</span> <span class="fu">lseBayes</span><span class="op">(</span><span class="va">yuima</span>, start<span class="op">=</span><span class="va">start</span>, prior<span class="op">=</span><span class="va">prior</span>,</span></span>
<span class="r-in"><span>                                    method<span class="op">=</span><span class="st">"mcmc"</span>,</span></span>
<span class="r-in"><span>                                    mcmc<span class="op">=</span><span class="fl">1000</span>,lower <span class="op">=</span> <span class="va">lower</span>, upper <span class="op">=</span> <span class="va">upper</span>,algorithm <span class="op">=</span> <span class="st">"randomwalk"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bayes1</span><span class="op">@</span><span class="va">coef</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bayes2</span> <span class="op">&lt;-</span> <span class="fu">lseBayes</span><span class="op">(</span><span class="va">yuima</span>, start<span class="op">=</span><span class="va">start</span>, prior<span class="op">=</span><span class="va">prior</span>,</span></span>
<span class="r-in"><span>                                    method<span class="op">=</span><span class="st">"mcmc"</span>,</span></span>
<span class="r-in"><span>                                    mcmc<span class="op">=</span><span class="fl">1000</span>,lower <span class="op">=</span> <span class="va">lower</span>, upper <span class="op">=</span> <span class="va">upper</span>,algorithm <span class="op">=</span> <span class="st">"MpCN"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bayes2</span><span class="op">@</span><span class="va">coef</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Stefano M. Iacus.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer></div>






  </body></html>

