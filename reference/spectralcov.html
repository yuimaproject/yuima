<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title> Spectral Method for Cumulative Covariance Estimation — spectralcov • The YUIMA Project</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content=" Spectral Method for Cumulative Covariance Estimation — spectralcov"><meta property="og:description" content="
This function implements the local method of moments proposed in Bibinger et al. (2014) to estimate the cummulative covariance matrix of a non-synchronously observed multi-dimensional Ito process with noise."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">The YUIMA Project</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.15.28</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/yuimaproject/yuima/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1><!-- %% ~~function to do ... ~~ --> Spectral Method for Cumulative Covariance Estimation</h1>

    <div class="hidden name"><code>spectralcov.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><!-- %%  ~~ A concise (1-5 lines) description of what the function does. ~~ -->
This function implements the local method of moments proposed in Bibinger et al. (2014) to estimate the cummulative covariance matrix of a non-synchronously observed multi-dimensional Ito process with noise.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">lmm</span><span class="op">(</span><span class="va">x</span>, block <span class="op">=</span> <span class="fl">20</span>, freq <span class="op">=</span> <span class="fl">50</span>, freq.p <span class="op">=</span> <span class="fl">10</span>, K <span class="op">=</span> <span class="fl">4</span>, interval <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>, </span>
<span>    Sigma.p <span class="op">=</span> <span class="cn">NULL</span>, noise.var <span class="op">=</span> <span class="st">"AMZ"</span>, samp.adj <span class="op">=</span> <span class="st">"direct"</span>, psd <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <p></p>
<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p><!-- %%     ~~Describe \code{x} here~~ -->
an object of  <code><a href="yuima-class.html">yuima-class</a></code> or <code><a href="yuima.data-class.html">yuima.data-class</a></code>.</p></dd>

  <dt id="arg-block">block<a class="anchor" aria-label="anchor" href="#arg-block"></a></dt>
<dd><p><!-- %%     ~~Describe \code{block} here~~ -->
a positive integer indicating the number of the blocks which the observation interval is split into.</p></dd>

  <dt id="arg-freq">freq<a class="anchor" aria-label="anchor" href="#arg-freq"></a></dt>
<dd><p><!-- %%     ~~Describe \code{freq} here~~ -->
a positive integer indicating the number of the frequencies used to compute the final estimator.</p></dd>

  <dt id="arg-freq-p">freq.p<a class="anchor" aria-label="anchor" href="#arg-freq-p"></a></dt>
<dd><p><!-- %%     ~~Describe \code{freq.p} here~~ -->
a positive integer indicating the number of the frequencies used to compute the pilot estimator for the spot covariance matrix (corresponding to the number \(J_n\) in Eq.(29) from Altmeyer and Bibinger (2015)).</p></dd>

  <dt id="arg-k">K<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p><!-- %%     ~~Describe \code{K} here~~ -->
a positive integer indicating the number of the blocks used to compute the pilot estimator for the spot covariance matrix (corresponding to the number \(K_n\) in Eq.(29) from Altmeyer and Bibinger (2015)).</p></dd>

  <dt id="arg-interval">interval<a class="anchor" aria-label="anchor" href="#arg-interval"></a></dt>
<dd><p><!-- %%     ~~Describe \code{interval} here~~ -->
a vector indicating the observation interval. The first component represents the initial value and the second component represents the terminal value.</p></dd>

  <dt id="arg-sigma-p">Sigma.p<a class="anchor" aria-label="anchor" href="#arg-sigma-p"></a></dt>
<dd><p><!-- %%     ~~Describe \code{Sigma.p} here~~ -->
a <code>block</code> by <code>dim(x)</code> matrix giving the pilot estimates of the spot covariance matrix plugged into the optimal weight matrices. If <code>NULL</code> (the default), it is computed by using formula (29) from Altmeyer and Bibinger (2015).</p></dd>

  <dt id="arg-noise-var">noise.var<a class="anchor" aria-label="anchor" href="#arg-noise-var"></a></dt>
<dd><p><!-- %%     ~~Describe \code{noise.var} here~~ -->
character string giving the method to estimate the noise variances. There are several options: <code>"AMZ"</code> (the default) uses equation (3.7) from Gatheral and Oomen (2010), i.e. the quasi-maximum likelihood estimator proposed by Ait-Sahalia et al. (2005) (see also Xiu (2010)). <code>"BR"</code> uses equation (3.9) from Gatheral and Oomen (2010), i.e. the sample average of the squared returns divided by 2, the estimator proposed by Bandi and Russel (2006). <code>"O"</code> uses equation (3.8) from Gatheral and Oomen (2010), i.e. another method-of-moments estimator proposed by Oomen (2006). It is also possible to directly specify the noise variances by setting this argument to a numeric vector. In this case the <code>i</code>-th component of <code>noise.var</code> must indicates the variance of the noise for the <code>i</code>-th component of the observation process.</p></dd>

  <dt id="arg-samp-adj">samp.adj<a class="anchor" aria-label="anchor" href="#arg-samp-adj"></a></dt>
<dd><p><!-- %%     ~~Describe \code{samp.adj} here~~ -->
character string giving the method to adjust the effect of the sampling times on the variances of the spectral statistics for the noise part. The default method <code>"direct"</code> uses the local sums of the squares of the one-skip differences of the sampling times divided by 2, which directly appears in the representation of the variances of the spectral statistics for the noise part. Another choice is <code>"QVT"</code>, which uses the local quadratic variations of time as in Altmeyer and Bibinger (2015) and Bibinger et al. (2014).</p></dd>

  <dt id="arg-psd">psd<a class="anchor" aria-label="anchor" href="#arg-psd"></a></dt>
<dd><p><!-- %%     ~~Describe \code{psd} here~~ -->
logical. If <code>TRUE</code> (the default), the estimated covariance matrix and variance-covariance matrix are converted to their spectral absolute values to ensure their positive semi-definiteness. This procedure does not matter in terms of the asymptotic theory.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p><!-- %%  ~~ If necessary, more details than the description above ~~ -->
The default implementation is the adaptive version of the local method of moments estimator, which is only based on observation data. It is possible to implement oracle versions of the estimator by setting user-specified <code>Sigma.p</code> and/or <code>noise.var</code>. An example is given below.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    <p><!-- %%  ~Describe the value returned -->
<!-- %%  If it is a LIST, use -->
<!-- %%  \item{comp1 }{Description of 'comp1'} -->
<!-- %%  \item{comp2 }{Description of 'comp2'} -->
<!-- %% ... -->
An object of class <code>"yuima.specv"</code>, which is a list with the following elements:</p>
<dl><dt>covmat</dt>
<dd><p>the estimated covariance matrix</p></dd>

<dt>vcov</dt>
<dd><p>the estimated variance-covariance matrix of <code>as.vector(covmat)</code></p></dd>

<dt>Sigma.p</dt>
<dd><p>the pilot estimates of the spot covariance matrix</p></dd>

</dl></div>
    <div id="references">
    <h2>References</h2>
    <p><!-- %% ~put references to the literature/web site here ~ -->
Ait-Sahalia, Y., Mykland, P. A. and Zhang, L. (2005)
  How often to sample a continuous-time process in the presence of market microstructure noise,
  <em>The Review of Financial Studies</em>, <b>18</b>, 351–416.</p>
<p>Altmeyer, R. and Bibinger, M. (2015)
  Functional stable limit theorems for quasi-efficient spectral covolatility estimators,
    to appear in <em>Stochastic processes and their applications</em>, doi:10.1016/j.spa.2015.07.009.</p>
<p>Bandi, F. M. and Russell, J. R. (2006)
  Separating microstructure noise from volatility,
  <em>Journal of Financial Economics</em>, <b>79</b>, 655–692.</p>
<p>Bibinger, M., Hautsch, N., Malec, P. and Reiss, M. (2014)
  Estimating the quadratic covariation matrix from noisy observations: local method of moments and efficiency,
  <em>Annals of Statistics</em>, <b>42</b>, 80–114.</p>
<p>Gatheral J. and Oomen, R. C. A. (2010)
  Zero-intelligence realized variance estimation,
  <em>Finance Stochastics</em>, <b>14</b>, 249–283.</p>
<p>Oomen, R. C. A. (2006)
  Properties of realized variance under alternative sampling schemes,
  <em>Journal of Business and Economic Statistics</em>, <b>24</b>, 219–237.</p>
<p>Reiss, M. (2011)
  Asymptotic equivalence for inference on the volatility from noisy observations,
  <em>Annals of Statistics</em>, <b>39</b>, 772–802.</p>
<p>Xiu, D. (2010)
  Quasi-maximum likelihood estimation of volatility with high frequency data,
  <em>Journal of Econometrics</em>, <b>159</b>, 235–250.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p><!-- %%  ~~who you are~~ -->
Yuta Koike with YUIMA Project Team</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><!-- %% ~~objects to See Also as \code{\link{help}}, ~~~ -->
<code><a href="cce.html">cce</a></code>, <code><a href="setData.html">setData</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example. One-dimensional and regular sampling case</span></span></span>
<span class="r-in"><span><span class="co"># Here the simulated model is taken from Reiss (2011)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Set a model</span></span></span>
<span class="r-in"><span><span class="va">sigma</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">t</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">0.02</span> <span class="op">+</span> <span class="fl">0.2</span> <span class="op">*</span> <span class="op">(</span><span class="va">t</span> <span class="op">-</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">^</span><span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">modI</span> <span class="op">&lt;-</span> <span class="fu"><a href="setModel.html">setModel</a></span><span class="op">(</span>drift <span class="op">=</span> <span class="fl">0</span>, diffusion <span class="op">=</span> <span class="st">"sigma(t)"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> YUIMA: Solution variable (lhs) not specified. Trying to use state variables.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Generate a path of the process</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">117</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">12000</span></span></span>
<span class="r-in"><span><span class="va">yuima.samp</span> <span class="op">&lt;-</span> <span class="fu"><a href="setSampling.html">setSampling</a></span><span class="op">(</span>Terminal <span class="op">=</span> <span class="fl">1</span>, n <span class="op">=</span> <span class="va">n</span><span class="op">)</span> </span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> YUIMA: 'delta' (re)defined.</span>
<span class="r-in"><span><span class="va">yuima</span> <span class="op">&lt;-</span> <span class="fu"><a href="setYuima.html">setYuima</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">modI</span>, sampling <span class="op">=</span> <span class="va">yuima.samp</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">yuima</span> <span class="op">&lt;-</span> <span class="fu"><a href="simulate.html">simulate</a></span><span class="op">(</span><span class="va">yuima</span>, xinit <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in object$deviance:</span> $ operator is invalid for atomic vectors</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">delta</span> <span class="op">&lt;-</span> <span class="fl">0.01</span> <span class="co"># standard deviation of microstructure noise</span></span></span>
<span class="r-in"><span><span class="va">yuima</span> <span class="op">&lt;-</span> <span class="fu"><a href="noisy.sampling.html">noisy.sampling</a></span><span class="op">(</span><span class="va">yuima</span>, var.adj <span class="op">=</span> <span class="va">delta</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="co"># generate noisy observations</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in n^(order.adj/2):</span> non-numeric argument to binary operator</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">yuima</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>no non-missing arguments to min; returning Inf</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>no non-missing arguments to max; returning -Inf</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>no non-missing arguments to min; returning Inf</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>no non-missing arguments to max; returning -Inf</span>
<span class="r-plt img"><img src="spectralcov-1.png" alt="" width="700" height="433"></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in plot.window(...):</span> need finite 'xlim' values</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Estimation of the integrated volatility</span></span></span>
<span class="r-in"><span><span class="va">est</span> <span class="op">&lt;-</span> <span class="fu">lmm</span><span class="op">(</span><span class="va">yuima</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in sapply(Data, "length") - 1:</span> non-numeric argument to binary operator</span>
<span class="r-in"><span><span class="va">est</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'est' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## True integrated volatility and theoretical standard error</span></span></span>
<span class="r-in"><span><span class="va">disc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, by <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"true integrated volatility\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> true integrated volatility</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sigma.html" class="external-link">sigma</a></span><span class="op">(</span><span class="va">disc</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.0225</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"theoretical standard error\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> theoretical standard error</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">8</span><span class="op">*</span><span class="va">delta</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sigma.html" class="external-link">sigma</a></span><span class="op">(</span><span class="va">disc</span><span class="op">[</span><span class="op">-</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span><span class="op">^</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="va">n</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.001576209</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plotting the pilot estimate of the spot variance path</span></span></span>
<span class="r-in"><span><span class="va">block</span> <span class="op">&lt;-</span> <span class="fl">20</span></span></span>
<span class="r-in"><span><span class="va">G</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">1</span>,by<span class="op">=</span><span class="fl">1</span><span class="op">/</span><span class="va">block</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">block</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">Sigma.p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sigma.html" class="external-link">sigma</a></span><span class="op">(</span><span class="va">G</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="co"># true spot variance</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/zoo/man/zoo.html" class="external-link">zoo</a></span><span class="op">(</span><span class="va">Sigma.p</span>, <span class="va">G</span><span class="op">)</span>, col <span class="op">=</span> <span class="st">"blue"</span>,, xlab <span class="op">=</span> <span class="st">"time"</span>, </span></span>
<span class="r-in"><span>     ylab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/sigma.html" class="external-link">sigma</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/pkg/zoo/man/zoo.html" class="external-link">zoo</a></span><span class="op">(</span><span class="va">est</span><span class="op">$</span><span class="va">Sigma.p</span>, <span class="va">G</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error:</span> object 'est' not found</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## "Oracle" implementation</span></span></span>
<span class="r-in"><span><span class="fu">lmm</span><span class="op">(</span><span class="va">yuima</span>, block <span class="op">=</span> <span class="va">block</span>, Sigma.p <span class="op">=</span> <span class="va">Sigma.p</span>, noise.var <span class="op">=</span> <span class="va">delta</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in sapply(Data, "length") - 1:</span> non-numeric argument to binary operator</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example. Multi-dimensional case</span></span></span>
<span class="r-in"><span><span class="co"># We simulate noisy observations of a correlated bivariate Brownian motion</span></span></span>
<span class="r-in"><span><span class="co"># First we examine the regular sampling case since in this situsation the theoretical standard </span></span></span>
<span class="r-in"><span><span class="co"># error can easily be computed via the formulae given in p.88 of Bibinger et al. (2014)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Set a model</span></span></span>
<span class="r-in"><span><span class="va">drift</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">rho</span> <span class="op">&lt;-</span> <span class="fl">0.5</span> <span class="co"># correlation</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">diffusion</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">rho</span>,<span class="fl">0</span>,<span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">rho</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">modII</span> <span class="op">&lt;-</span> <span class="fu"><a href="setModel.html">setModel</a></span><span class="op">(</span>drift<span class="op">=</span><span class="va">drift</span>,diffusion<span class="op">=</span><span class="va">diffusion</span>,</span></span>
<span class="r-in"><span>                  state.variable<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x1"</span>,<span class="st">"x2"</span><span class="op">)</span>,solve.variable<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x1"</span>,<span class="st">"x2"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>                  </span></span>
<span class="r-in"><span><span class="co">## Generate a path of the latent process</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## We regard the unit interval as 6.5 hours and generate the path on it </span></span></span>
<span class="r-in"><span><span class="co">## with the step size equal to 1 seconds</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fl">8000</span></span></span>
<span class="r-in"><span><span class="va">yuima.samp</span> <span class="op">&lt;-</span> <span class="fu"><a href="setSampling.html">setSampling</a></span><span class="op">(</span>Terminal <span class="op">=</span> <span class="fl">1</span>, n <span class="op">=</span> <span class="va">n</span><span class="op">)</span> </span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> YUIMA: 'delta' (re)defined.</span>
<span class="r-in"><span><span class="va">yuima</span> <span class="op">&lt;-</span> <span class="fu"><a href="setYuima.html">setYuima</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">modII</span>, sampling <span class="op">=</span> <span class="va">yuima.samp</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">yuima</span> <span class="op">&lt;-</span> <span class="fu"><a href="simulate.html">simulate</a></span><span class="op">(</span><span class="va">yuima</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Generate noisy observations</span></span></span>
<span class="r-in"><span><span class="va">eta</span> <span class="op">&lt;-</span> <span class="fl">0.05</span></span></span>
<span class="r-in"><span><span class="va">yuima</span> <span class="op">&lt;-</span> <span class="fu"><a href="noisy.sampling.html">noisy.sampling</a></span><span class="op">(</span><span class="va">yuima</span>, var.adj <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/diag.html" class="external-link">diag</a></span><span class="op">(</span><span class="va">eta</span><span class="op">^</span><span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">yuima</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Estimation of the integrated covariance matrix</span></span></span>
<span class="r-in"><span><span class="va">est</span> <span class="op">&lt;-</span> <span class="fu">lmm</span><span class="op">(</span><span class="va">yuima</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">est</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated covariance matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]      [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.9768313 0.5523975</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.5523975 0.9732599</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]       [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.06942057 0.05025903</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.05025903 0.06065253</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Theoretical standard error</span></span></span>
<span class="r-in"><span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">4</span> <span class="op">*</span> <span class="va">eta</span> <span class="op">*</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">rho</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">rho</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">2</span> <span class="op">*</span> <span class="va">eta</span> <span class="op">*</span> <span class="op">(</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">rho</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">3</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">rho</span><span class="op">)</span><span class="op">^</span><span class="op">(</span><span class="fl">3</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"theoretical standard error\n"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> theoretical standard error</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">a</span>,<span class="va">b</span>,<span class="va">b</span>,<span class="va">a</span><span class="op">)</span>,<span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="va">n</span><span class="op">^</span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">4</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]       [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.06572482 0.04948984</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.04948984 0.06572482</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## "Oracle" implementation</span></span></span>
<span class="r-in"><span><span class="va">block</span> <span class="op">&lt;-</span> <span class="fl">20</span></span></span>
<span class="r-in"><span><span class="va">Sigma.p</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="va">rho</span>,<span class="va">rho</span>,<span class="fl">1</span><span class="op">)</span>,<span class="va">block</span>,<span class="fl">4</span>,byrow<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span> <span class="co"># true spot covariance matrix</span></span></span>
<span class="r-in"><span><span class="fu">lmm</span><span class="op">(</span><span class="va">yuima</span>, block <span class="op">=</span> <span class="va">block</span>, Sigma.p <span class="op">=</span> <span class="va">Sigma.p</span>, noise.var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">eta</span><span class="op">^</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated covariance matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]      [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.9854978 0.5541464</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.5541464 0.9779647</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]       [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.06874854 0.05209095</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.05209095 0.06874854</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Next we extract nonsynchronous observations from </span></span></span>
<span class="r-in"><span><span class="co"># the path generated above by Poisson random sampling</span></span></span>
<span class="r-in"><span><span class="va">psample</span> <span class="op">&lt;-</span> <span class="fu"><a href="poisson.random.sampling.html">poisson.random.sampling</a></span><span class="op">(</span><span class="va">yuima</span>, rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">/</span><span class="fl">2</span>,<span class="fl">1</span><span class="op">/</span><span class="fl">2</span><span class="op">)</span>, n <span class="op">=</span> <span class="va">n</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Estimation of the integrated covariance matrix</span></span></span>
<span class="r-in"><span><span class="fu">lmm</span><span class="op">(</span><span class="va">psample</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated covariance matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]      [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.9514230 0.5414584</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.5414584 0.8993825</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]       [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.09392599 0.06553291</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.06553291 0.07685174</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## "Oracle" implementation</span></span></span>
<span class="r-in"><span><span class="fu">lmm</span><span class="op">(</span><span class="va">psample</span>, block <span class="op">=</span> <span class="va">block</span>, Sigma.p <span class="op">=</span> <span class="va">Sigma.p</span>, noise.var <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="va">eta</span><span class="op">^</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated covariance matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]      [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.9568415 0.5460105</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.5460105 0.9132695</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]       [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.09125362 0.06865381</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.06865381 0.09113207</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Other choices of tuning parameters (estimated values are not varied so much)</span></span></span>
<span class="r-in"><span><span class="fu">lmm</span><span class="op">(</span><span class="va">psample</span>, block <span class="op">=</span> <span class="fl">25</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated covariance matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]      [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.8825394 0.5235989</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.5235989 0.8562766</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]       [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.08611861 0.06704723</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.06704723 0.08876909</span>
<span class="r-in"><span><span class="fu">lmm</span><span class="op">(</span><span class="va">psample</span>, freq <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated covariance matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]      [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.8739147 0.4911475</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.4911475 0.8433302</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]      [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.09327055 0.0650239</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.06502390 0.0764426</span>
<span class="r-in"><span><span class="fu">lmm</span><span class="op">(</span><span class="va">psample</span>, freq.p <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated covariance matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]      [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.9561540 0.5393448</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.5393448 0.8984522</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]       [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.08776138 0.06800662</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.06800662 0.08900640</span>
<span class="r-in"><span><span class="fu">lmm</span><span class="op">(</span><span class="va">psample</span>, K <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated covariance matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           [,1]      [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.9637256 0.5462901</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.5462901 0.9019694</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Standard Error</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]       [,2]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.09440473 0.06593944</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.06593944 0.07743319</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Stefano M. Iacus.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

