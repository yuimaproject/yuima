<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Lead Lag Estimator — llag • The YUIMA Project</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Lead Lag Estimator — llag"><meta property="og:description" content="Estimate the lead-lag parameters of discretely observed processes by maximizing the shifted Hayashi-Yoshida covariation contrast functions, following Hoffmann et al. (2013)."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">The YUIMA Project</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.15.18</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"></ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Lead Lag Estimator</h1>
    
    <div class="hidden name"><code>llag.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Estimate the lead-lag parameters of discretely observed processes by maximizing the shifted Hayashi-Yoshida covariation contrast functions, following Hoffmann et al. (2013).</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">llag</span><span class="op">(</span><span class="va">x</span>, from <span class="op">=</span> <span class="op">-</span><span class="cn">Inf</span>, to <span class="op">=</span> <span class="cn">Inf</span>, division <span class="op">=</span> <span class="cn">FALSE</span>, verbose <span class="op">=</span> <span class="op">(</span><span class="va">ci</span> <span class="op">||</span> <span class="va">ccor</span><span class="op">)</span>, </span>
<span>     <span class="va">grid</span>, psd <span class="op">=</span> <span class="cn">TRUE</span>, plot <span class="op">=</span> <span class="va">ci</span>, ccor <span class="op">=</span> <span class="va">ci</span>, ci <span class="op">=</span> <span class="cn">FALSE</span>, alpha <span class="op">=</span> <span class="fl">0.01</span>, </span>
<span>     fisher <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">bw</span>, tol <span class="op">=</span> <span class="fl">1e-6</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>x</dt>
<dd><p>an object of  <code><a href="yuima-class.html">yuima-class</a></code> or <code><a href="yuima.data-class.html">yuima.data-class</a></code>.</p></dd>


<dt>verbose</dt>
<dd><p>whether <code>llag</code> returns matrices or not. The default is <code>FALSE</code>.</p></dd>


<dt>from</dt>
<dd><p>a numeric vector each of whose component(s) indicates the lower end of a finite grid on which the contrast function is evaluated, if <code>grid</code> is missing.</p></dd>


<dt>to</dt>
<dd><p>a numeric vector each of whose component(s) indicates the upper end of a finite grid on which the contrast function is evaluated, if <code>grid</code> is missing.</p></dd>


<dt>division</dt>
<dd><p>a numeric vector each of whose component(s) indicates the number of the points of a finite grid on which the contrast function is evaluated, if <code>grid</code> is missing.</p></dd>


<dt>grid</dt>
<dd><p>a numeric vector or a list of numeric vectors. See 'Details'.</p></dd>


<dt>psd</dt>
<dd><p>logical. If <code>TRUE</code>, the estimated cross-correlation functions are converted to the interval [-1,1]. See 'Details'.</p></dd>


<dt>plot</dt>
<dd><p>logical. If <code>TRUE</code>, the estimated cross-correlation functions are plotted. If <code>ci</code> is also <code>TRUE</code>, the pointwise confidence intervals (under the null hypothesis that the corresponding correlation is zero) are also plotted. The default is <code>FALSE</code>.</p></dd>


<dt>ccor</dt>
<dd><p>logical. If <code>TRUE</code>, the estimated cross-correlation functions are returned. This argument is ignored if <code>verbose</code> is <code>FALSE</code>. The default is <code>FALSE</code>.</p></dd>


<dt>ci</dt>
<dd><p>logical. If <code>TRUE</code>, (pointwise) confidence intervals of the estimated cross-correlation functions and p-values for the significance of the correlations at the estimated lead-lag parameters are calculated. Note that the confidence intervals are only plotted when <code>plot=TRUE</code>.</p></dd>


<dt>alpha</dt>
<dd><p>a posive number indicating the significance level of the confidence intervals for the cross-correlation functions.</p></dd>


<dt>fisher</dt>
<dd><p>logical. If <code>TRUE</code>, the p-values and the confidence intervals for the cross-correlation functions is evaluated after applying the Fisher z transformation. This argument is only meaningful if <code>pval = "corr"</code>.</p></dd>


<dt>bw</dt>
<dd><p>bandwidth parameter to compute the asymptotic variances. See 'Details' and <code><a href="hyavar.html">hyavar</a></code> for details.</p></dd>


<dt>tol</dt>
<dd><p>tolelance parameter to avoid numerical errors in comparison of time stamps. All time stamps are divided by <code>tol</code> and rounded to integers. Note that the values of <code>grid</code> are also divided by <code>tol</code> and rounded to integers. A reasonable choice of <code>tol</code> is the minimum unit of time stamps. The default value <code>1e-6</code> supposes that the minimum unit of time stamps is greater or equal to 1 micro-second.</p></dd>

</dl></div>
    <div id="details">
    <h2>Details</h2>
    <p>Let \(d\) be the number of the components of the <code>zoo.data</code> of the object <code>x</code>.</p>
<p>Let \(Xi_{ti_0},Xi_{ti_1},\dots,Xi_{ti_n(i)}\) be the observation data of the \(i\)-th component (i.e. the \(i\)-th component of the <code>zoo.data</code> of the object <code>x</code>).</p>
<p>The shifted Hayashi-Yoshida covariation contrast function \(Uij(\theta)\) of the observations \(Xi\) and \(Xj\) \((i&lt;j)\) is defined by the same way as in Hoffmann et al. (2013), which corresponds to their cross-covariance function. The lead-lag parameter \(\theta_ij\) is defined as a maximizer of \(|Uij(\theta)|\). \(Uij(\theta)\) is evaluated on a finite grid \(Gij\) defined below. Thus \(\theta_ij\) belongs to this grid. If there exist more than two maximizers, the lowest one is selected.</p>
<p>If <code>psd</code> is <code>TRUE</code>, for any \(i,j\) the matrix \(C:=(Ukl(\theta))_{k,l\in{i,j}}\) is converted to <code>(C%*%C)^(1/2)</code> for ensuring the positive semi-definiteness, and \(Uij(\theta)\) is redefined as the \((1,2)\)-component of the converted \(C\). Here, \(Ukk(\theta)\) is set to the realized volatility of \(Xk\). In this case \(\theta_ij\) is given as a maximizer of the cross-correlation functions.</p>
<p>The grid \(Gij\) is defined as follows. First, if <code>grid</code> is missing, \(Gij\) is given by  
$$a, a+(b-a)/(N-1), \dots, a+(N-2)(b-a)/(N-1), b,$$
where \(a,b\) and \(N\) are the \((d(i-1)-(i-1)i/2+(j-i))\)-th components of <code>from</code>, <code>to</code> and <code>division</code> respectively.  If the corresponding component of <code>from</code> (resp. <code>to</code>) is <code>-Inf</code> (resp. <code>Inf</code>), \(a=-(tj_n(j)-ti_0)\) (resp. \(b=ti_n(i)-tj_0\)) is used, while if the corresponding component of <code>division</code> is <code>FALSE</code>, \(N=round(2max(n(i),n(j)))+1\) is used. Missing components are filled with <code>-Inf</code> (resp. <code>Inf</code>, <code>FALSE</code>). The default value <code>-Inf</code> (resp. <code>Inf</code>, <code>FALSE</code>) means that all components are <code>-Inf</code> (resp. <code>Inf</code>, <code>FALSE</code>). Next, if <code>grid</code> is a numeric vector, \(Gij\) is given by <code>grid</code>. If <code>grid</code> is a list of numeric vectors, \(Gij\) is given by the \((d(i-1)-(i-1)i/2+(j-i))\)-th component of <code>grid</code>.</p>
<p>The estimated lead-lag parameters are returned as the skew-symmetric matrix \((\theta_ij)_{i,j=1,\dots,d}\). If <code>verbose</code> is <code>TRUE</code>, the covariance matrix \((Uij(\theta_ij))_{i,j=1,\dots,d}\) corresponding to the estimated lead-lag parameters, the corresponding correlation matrix and the computed contrast functions are also returned. If further <code>ccor</code> is <code>TRUE</code>,the computed cross-correlation functions are returned as a list with the length \(d(d-1)/2\). For \(i&lt;j\), the \((d(i-1)-(i-1)i/2+(j-i))\)-th component of the list consists of an object \(Uij(\theta)/sqrt(Uii(\theta)*Ujj(\theta))\) of class zoo indexed by \(Gij\).</p>
<p>If <code>plot</code> is <code>TRUE</code>, the computed cross-correlation functions are plotted sequentially.</p>
<p>If <code>ci</code> is <code>TRUE</code>, the asymptotic variances of the cross-correlations are calculated at each point of the grid by using the naive kernel approach descrived in Section 8.2 of Hayashi and Yoshida (2011). The implementation is the same as that of <code><a href="hyavar.html">hyavar</a></code> and more detailed description is found there.</p>
    </div>
    <div id="value">
    <h2>Value</h2>
    

<p>If <code>verbose</code> is <code>FALSE</code>, a skew-symmetric matrix corresponding to the estimated lead-lag parameters is returned. 
Otherwise, an object of class <code>"yuima.llag"</code>, which is a list with the following components, is returned:</p>
<dl><dt>lagcce</dt>
<dd><p>a skew-symmetric matrix corresponding to the estimated lead-lag parameters.</p></dd>

<dt>covmat</dt>
<dd><p>a covariance matrix corresponding to the estimated lead-lag parameters.</p></dd>

<dt>cormat</dt>
<dd><p>a correlation matrix corresponding to the estimated lead-lag parameters.</p></dd>

<dt>LLR</dt>
<dd><p>a matrix consisting of lead-lag ratios. See Huth and Abergel (2014) for details.</p></dd>


</dl><p>If <code>ci</code> is <code>TRUE</code>, the following component is added to the returned list:</p>
<dl><dt>p.values</dt>
<dd><p>a matrix of p-values for the significance of the correlations corresponding to the estimated lead-lag parameters.</p></dd>


</dl><p>If further <code>ccor</code> is <code>TRUE</code>, the following components are added to the returned list:</p>
<dl><dt>ccor</dt>
<dd><p>a list of computed cross-correlation functions.</p></dd>

<dt>avar</dt>
<dd><p>a list of computed asymptotic variances of the cross-correlations (if <code>ci = TRUE</code>).</p></dd>

</dl></div>
    <div id="note">
    <h2>Note</h2>
    <p>The default <code>grid</code> usually contains too many points, so it is better for users to specify this argument in order to reduce the computational time. See 'Examples' below for an example of the specification.</p>
<p>The evaluated p-values should carefully be interpreted because they are calculated based on <em>pointwise confidence intervals</em> rather than <em>simultaneous confidence intervals</em> (so there would be a multiple testing problem). Evaluation of p-values based on the latter will be implemented in the future extension of this function: Indeed, so far no theory has been developed for this. However, it is conjectured that the error distributions of the estimated cross-correlation functions are asymptotically independent if the grid is not dense too much, so p-values evaluated by this function will still be meaningful as long as sufficiently low significance levels are used.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Hayashi, T. and Yoshida, N. (2011)
  Nonsynchronous covariation process and limit theorems,
  <em>Stochastic processes and their applications</em>, <b>121</b>, 2416--2454.</p>  
<p>Hoffmann, M., Rosenbaum, M. and Yoshida, N. (2013)
  Estimation of the lead-lag parameter from non-synchronous data, 
  <em>Bernoulli</em>, <b>19</b>, no. 2, 426--461.</p>  
<p>Huth, N. and Abergel, F. (2014)
  High frequency lead/lag relationships --- Empirical facts,
  <em>Journal of Empirical Finance</em>, <b>26</b>, 41--58.</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Yuta Koike with YUIMA Project Team</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="cce.html">cce</a></code>, <code><a href="hyavar.html">hyavar</a></code>, <code><a href="mllag.html">mllag</a></code>, <code><a href="llag.test.html">llag.test</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Set a model</span></span></span>
<span class="r-in"><span><span class="va">diff.coef.matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sqrt(x1)"</span>, <span class="st">"3/5*sqrt(x2)"</span>,</span></span>
<span class="r-in"><span> <span class="st">"1/3*sqrt(x3)"</span>, <span class="st">""</span>, <span class="st">"4/5*sqrt(x2)"</span>,<span class="st">"2/3*sqrt(x3)"</span>,</span></span>
<span class="r-in"><span> <span class="st">""</span>,<span class="st">""</span>,<span class="st">"2/3*sqrt(x3)"</span><span class="op">)</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">drift</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1-x1"</span>,<span class="st">"2*(10-x2)"</span>,<span class="st">"3*(4-x3)"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">cor.mod</span> <span class="op">&lt;-</span> <span class="fu"><a href="setModel.html">setModel</a></span><span class="op">(</span>drift <span class="op">=</span> <span class="va">drift</span>, </span></span>
<span class="r-in"><span> diffusion <span class="op">=</span> <span class="va">diff.coef.matrix</span>,</span></span>
<span class="r-in"><span> solve.variable <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x1"</span>, <span class="st">"x2"</span>,<span class="st">"x3"</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">111</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## We use a function poisson.random.sampling </span></span></span>
<span class="r-in"><span><span class="co">## to get observation by Poisson sampling.</span></span></span>
<span class="r-in"><span><span class="va">yuima.samp</span> <span class="op">&lt;-</span> <span class="fu"><a href="setSampling.html">setSampling</a></span><span class="op">(</span>Terminal <span class="op">=</span> <span class="fl">1</span>, n <span class="op">=</span> <span class="fl">1200</span><span class="op">)</span> </span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> YUIMA: 'delta' (re)defined.</span>
<span class="r-in"><span><span class="va">yuima</span> <span class="op">&lt;-</span> <span class="fu"><a href="setYuima.html">setYuima</a></span><span class="op">(</span>model <span class="op">=</span> <span class="va">cor.mod</span>, sampling <span class="op">=</span> <span class="va">yuima.samp</span><span class="op">)</span> </span></span>
<span class="r-in"><span><span class="va">yuima</span> <span class="op">&lt;-</span> <span class="fu"><a href="simulate.html">simulate</a></span><span class="op">(</span><span class="va">yuima</span>,xinit<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">7</span>,<span class="fl">5</span><span class="op">)</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## intentionally displace the second time series</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">data2</span> <span class="op">&lt;-</span> <span class="va">yuima</span><span class="op">@</span><span class="va">data</span><span class="op">@</span><span class="va">zoo.data</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">time2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/time.html" class="external-link">time</a></span><span class="op">(</span><span class="va">data2</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">theta2</span> <span class="op">&lt;-</span> <span class="fl">0.05</span>   <span class="co"># the lag of x2 behind x1</span></span></span>
<span class="r-in"><span>  <span class="va">stime2</span> <span class="op">&lt;-</span> <span class="va">time2</span> <span class="op">+</span> <span class="va">theta2</span>  </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/time.html" class="external-link">time</a></span><span class="op">(</span><span class="va">yuima</span><span class="op">@</span><span class="va">data</span><span class="op">@</span><span class="va">zoo.data</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">stime2</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span>  <span class="va">data3</span> <span class="op">&lt;-</span> <span class="va">yuima</span><span class="op">@</span><span class="va">data</span><span class="op">@</span><span class="va">zoo.data</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span>  <span class="va">time3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/time.html" class="external-link">time</a></span><span class="op">(</span><span class="va">data3</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">theta3</span> <span class="op">&lt;-</span> <span class="fl">0.12</span>   <span class="co"># the lag of x3 behind x1</span></span></span>
<span class="r-in"><span>  <span class="va">stime3</span> <span class="op">&lt;-</span> <span class="va">time3</span> <span class="op">+</span> <span class="va">theta3</span> </span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/stats/time.html" class="external-link">time</a></span><span class="op">(</span><span class="va">yuima</span><span class="op">@</span><span class="va">data</span><span class="op">@</span><span class="va">zoo.data</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">stime3</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## sampled data by Poisson rules</span></span></span>
<span class="r-in"><span><span class="va">psample</span><span class="op">&lt;-</span> <span class="fu"><a href="poisson.random.sampling.html">poisson.random.sampling</a></span><span class="op">(</span><span class="va">yuima</span>, </span></span>
<span class="r-in"><span> rate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>,<span class="fl">0.3</span>,<span class="fl">0.4</span><span class="op">)</span>, n <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## plot</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">psample</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="llag-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## cce</span></span></span>
<span class="r-in"><span><span class="fu"><a href="cce.html">cce</a></span><span class="op">(</span><span class="va">psample</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $covmat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Series 1  Series 2  Series 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 1 1.0341733 0.3703059 0.1689927</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 2 0.3703059 8.4164209 0.3131220</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 3 0.1689927 0.3131220 3.8125561</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cormat</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Series 1   Series 2   Series 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 1 1.00000000 0.12551634 0.08510659</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 2 0.12551634 1.00000000 0.05527664</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 3 0.08510659 0.05527664 1.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## lead-lag estimation (with cross-correlation plots)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfcol<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">llag</span><span class="op">(</span><span class="va">psample</span>, plot<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="llag-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## estimated lead-lag parameter</span></span></span>
<span class="r-in"><span><span class="va">result</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Series 1    Series 2   Series 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 1  0.0000000  0.05232350 0.12000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 2 -0.0523235  0.00000000 0.07151363</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 3 -0.1200000 -0.07151363 0.00000000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## computing pointwise confidence intervals</span></span></span>
<span class="r-in"><span><span class="fu">llag</span><span class="op">(</span><span class="va">psample</span>, ci <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="llag-3.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated lead-lag parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Series 1    Series 2   Series 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 1  0.0000000  0.05232350 0.12000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 2 -0.0523235  0.00000000 0.07151363</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 3 -0.1200000 -0.07151363 0.00000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Corresponding p-values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Series 1     Series 2     Series 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 1 1.000000e+00 8.178210e-06 1.349969e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 2 8.178210e-06 1.000000e+00 2.062519e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 3 1.349969e-04 2.062519e-06 1.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Corresponding covariance matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Series 1 Series 2  Series 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 1 1.0341733 1.731379 0.8433603</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 2 1.7313790 8.416421 3.6797097</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 3 0.8433603 3.679710 3.8125561</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Corresponding correlation matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Series 1  Series 2  Series 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 1 1.0000000 0.5868563 0.4247255</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 2 0.5868563 1.0000000 0.6495936</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 3 0.4247255 0.6495936 1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lead-lag ratio</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Series 1 Series 2 Series 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 1 1.0000000 2.251106 2.560784</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 2 0.4442260 1.000000 1.842937</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 3 0.3905055 0.542612 1.000000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## In practice, it is better to specify the grid because the default grid contains too many points.</span></span></span>
<span class="r-in"><span><span class="co">## Here we give an example for how to specify it.</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## We search lead-lag parameters on the interval [-0.1, 0.1] with step size 0.01 </span></span></span>
<span class="r-in"><span><span class="va">G</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">0.1</span>,<span class="fl">0.1</span>,by<span class="op">=</span><span class="fl">0.01</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## lead-lag estimation (with computing confidence intervals)</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">llag</span><span class="op">(</span><span class="va">psample</span>, grid <span class="op">=</span> <span class="va">G</span>, ci <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="llag-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Since the true lead-lag parameter 0.12 between x1 and x3 is not contained</span></span></span>
<span class="r-in"><span><span class="co">## in the searching grid G, we see that the corresponding cross-correlation </span></span></span>
<span class="r-in"><span><span class="co">## does not exceed the cofidence interval</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## detailed output</span></span></span>
<span class="r-in"><span><span class="co">## the p-value for the (1,3)-th component is high</span></span></span>
<span class="r-in"><span><span class="va">result</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Estimated lead-lag parameters</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          Series 1 Series 2 Series 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 1     0.00     0.05     0.10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 2    -0.05     0.00     0.07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 3    -0.10    -0.07     0.00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Corresponding p-values</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              Series 1     Series 2     Series 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 1 1.000000e+00 3.280303e-06 2.502310e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 2 3.280303e-06 1.000000e+00 4.622514e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 3 2.502310e-02 4.622514e-07 1.000000e+00</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Corresponding covariance matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Series 1 Series 2   Series 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 1  1.0341733 1.725663 -0.4725133</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 2  1.7256633 8.416421  3.7335168</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 3 -0.4725133 3.733517  3.8125561</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Corresponding correlation matrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Series 1  Series 2   Series 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 1  1.0000000 0.5849189 -0.2379629</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 2  0.5849189 1.0000000  0.6590923</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 3 -0.2379629 0.6590923  1.0000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lead-lag ratio</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Series 1  Series 2 Series 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 1 1.0000000 4.1345671 2.427283</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 2 0.2418633 1.0000000 4.436410</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Series 3 0.4119833 0.2254075 1.000000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Finally, we can examine confidence intervals of other significant levels</span></span></span>
<span class="r-in"><span><span class="co">## and/or without the Fisher z-transformation via the plot-method defined </span></span></span>
<span class="r-in"><span><span class="co">## for yuima.llag-class objects as follows</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result</span>, alpha <span class="op">=</span> <span class="fl">0.001</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="llag-5.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">result</span>, fisher <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="llag-6.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html" class="external-link">par</a></span><span class="op">(</span>mfcol<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Stefano M. Iacus.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

